@using Microsoft.AspNetCore.Identity
@model ShowroomViewModel
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Showroom</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link type="text/css" rel="stylesheet" href="/css/ShowroomMain.css">
    <link type="text/css" rel="stylesheet" href="/css/ShowroomStyleSheet.css">
    <style>
        #blocker {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        #instructions {
            width: 100%;
            height: 100%;
            display: -webkit-box;
            display: -moz-box;
            display: box;
            -webkit-box-orient: horizontal;
            -moz-box-orient: horizontal;
            box-orient: horizontal;
            -webkit-box-pack: center;
            -moz-box-pack: center;
            box-pack: center;
            -webkit-box-align: center;
            -moz-box-align: center;
            box-align: center;
            color: #ffffff;
            text-align: center;
            font-family: Arial;
            font-size: 14px;
            line-height: 24px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    
    <div id="plus-sign">+</div>
    <div id="arrow-keys">
        <div id="arrow-move-forward">▲</div>
        <div id="arrow-move-backward">▼</div>
    </div>

    <div id="blocker">
        <div id="instructions">
            <span style="font-size:36px">Counter-Art! Click to start</span>
            <br /><br />
            Move: WASD<br />
            Look: MOUSE
        </div>
        <div id="artInfo">
            <ul id="myUL">
                @for (int i = 0; i < Model.Images.Count(); i++)
                {
                    <li id="@(i+1)" style="display: none">
                        <div id="art-info-text">
                            <h1 id="painting-title">@Model.ArtworkInformation.ElementAt(i).Title</h1>
                           <p id="art-artist">Artist: @Model.ArtworkInformation.ElementAt(i).Firstname @Model.ArtworkInformation.ElementAt(i).Lastname</p>
                            <p id="art-year">Year: @Model.ArtworkInformation.ElementAt(i).Year</p>
                            <p id="art-description">Description: @Model.ArtworkInformation.ElementAt(i).Description</p>
                            <p id="art-type">Type: @Model.ArtworkInformation.ElementAt(i).Type</p>
                            <p id="art-height-width">Measurements: @Model.ArtworkInformation.ElementAt(i).Height x @Model.ArtworkInformation.ElementAt(i).Width cm</p>
                        </div>
                        <div id=art-source><img src="/imagesArt/@Model.ArtworkInformation.ElementAt(i).Source"></div>
                    </li>
                }

                @*Detta är bara för att det inte finns tillräckligt mycket konstverk att titta på ATM.*@
                @*@for (int i = 0; i < 16; i++)
                {
                    <li id="@(i+1)" style="display: none">
                        <div id="art-info-text">
                            <h1 id="painting-title">@Model.Images.ElementAt(0).ArtName</h1>
                            <p id="art-artist">Artist: @Model.Images.ElementAt(0).Firstname @Model.Images.ElementAt(0).Lastname</p>
                            <p id="art-year">Year: @Model.Images.ElementAt(0).Year</p>
                            <p id="art-description">Description: @Model.Images.ElementAt(0).Description</p>
                            <p id="art-type">Type: @Model.Images.ElementAt(0).Type</p>
                            <p id="art-height-width">Measurements: @Model.Images.ElementAt(0).Height x @Model.Images.ElementAt(0).Width cm</p>
                        </div>
                        <div id=art-source><img src="/imagesArt/@Model.Images.ElementAt(0).ImageName"></div>
                    </li>
                }*@
            </ul>
            <div id="cross"><img src="/images/cross.png" /></div>
           
        </div>
        <div id="exit" style="display: none">
            <h1>Do you want to exit the exhibition?</h1>
            <form>
                <input type="button" value="Yes" onclick="history.back()">
                <input type="button" id="exit-no" value="No">
            </form>
        </div>

    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/102/three.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.2/TweenMax.min.js"></script>
    <script type="module">

        import * as THREE from '/js/three.module.js';

        import { PointerLockControls } from '/js/PointerLockControls.js';

        let camera, scene, renderer, controls;

        const objects = [];


        let raycaster;

        let moveForward = false;
        let moveBackward = false;
        let moveLeft = false;
        let moveRight = false;
        let canJump = false;
        let artIsClicked = false;
        let exitIsClicked = false;
        let onMobileDevice = false;
        let artInfoPicture;
        let artInfoName;

        let prevTime = performance.now();
        const velocity = new THREE.Vector3();
        const direction = new THREE.Vector3();
        const vertex = new THREE.Vector3();
        const color = new THREE.Color();
        var mouse = new THREE.Vector2();
        var lastX, lastY;

        init();
        animate();
        function hideAllArtInfo() {

            for (var i = 0; i < document.getElementById("myUL").children.length; i++) {

                document.getElementById("myUL").children[i].style.display = "none"
            }

        }
        function showArtInfo(image) {
            var ul, li
            ul = document.getElementById("myUL")
            li = ul.getElementsByTagName('li')
            for (var i = 0; i < li.length; i++) {
                if (li[i].id == image.Number) {
                    li[i].style.display = "block"
                }
            }

        }
        function init() {

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1000);
            camera.position.y = 10;

            scene = new THREE.Scene();


            scene.background = new THREE.Color(0xffffff);
            scene.fog = new THREE.Fog(0xffffff, 0, 750);

            const light = new THREE.HemisphereLight(0xFFFFFF, 0xFFFFFF, 0.9);
            light.position.set(0, 0, 0);
            scene.add(light);

            controls = new PointerLockControls(camera, document.body);

            const blocker = document.getElementById('blocker');
            const instructions = document.getElementById('instructions');




            const artInfo = document.getElementById('artInfo');
            const artInfoSource = document.getElementById('myUL');
            const exitDetailsCross = document.getElementById('cross');





            const exitScreen = document.getElementById('exit');
            const exitScreenNo = document.getElementById('exit-no');

            artInfo.style.display = 'none';
            exitScreen.style.display = 'none';

            exitDetailsCross.addEventListener('touchstart', function () {
                controls.lock();
            });

            instructions.addEventListener('click', function () {

                controls.lock();

            }, false);

            artInfoSource.addEventListener('click', function () {

                controls.lock();
            })
            controls.addEventListener('lock', function () {

                instructions.style.display = 'none';
                blocker.style.display = 'none';
                artIsClicked = false;
                exitIsClicked = false;
                artInfo.style.display = 'none'
                exitScreen.style.display = 'none';
                hideAllArtInfo();

                if (onMobileDevice === true) {
                    controls.unlock();
                }
            });

            controls.addEventListener('unlock', function () {

                if (artIsClicked === true) {
                    blocker.style.display = 'block';
                    artInfo.style.display = 'block';


                }
                else if (exitIsClicked === true) {
                    blocker.style.display = 'block';
                    exitScreen.style.display = 'block';

                } else if (onMobileDevice === true && exitIsClicked != true && artIsClicked != true) {
                    blocker.style.display = 'none';
                } else {

                    blocker.style.display = 'block';
                    instructions.style.display = '';
                }

            });


            exitScreenNo.addEventListener('click', function () {
                controls.lock();
            });

            scene.add(controls.getObject());



            //Movement keys
            document.getElementById('arrow-move-forward').addEventListener('touchstart', function () {
                moveForward = true;
            });
            document.getElementById('arrow-move-forward').addEventListener('touchend', function () {
                moveForward = false;
            });


            document.getElementById('arrow-move-backward').addEventListener('touchstart', function () {
                moveBackward = true;
            });
            document.getElementById('arrow-move-backward').addEventListener('touchend', function () {
                moveBackward = false;
            });



            const onKeyDown = function (event) {
                switch (event.keyCode) {

                    case 38: // up
                    case 87: // w
                        moveForward = true;
                        break;

                    case 37: // left
                    case 65: // a
                        moveLeft = true;
                        break;

                    case 40: // down
                    case 83: // s
                        moveBackward = true;
                        break;

                    case 39: // right
                    case 68: // d
                        moveRight = true;
                        break;
                }

            };

            const onKeyUp = function (event) {

                switch (event.keyCode) {

                    case 38: // up
                    case 87: // w
                        moveForward = false;
                        break;

                    case 37: // left
                    case 65: // a
                        moveLeft = false;
                        break;

                    case 40: // down
                    case 83: // s
                        moveBackward = false;
                        break;

                    case 39: // right
                    case 68: // d
                        moveRight = false;
                        break;


                }

            };

            document.addEventListener('keydown', onKeyDown, false);
            document.addEventListener('keyup', onKeyUp, false);
            document.addEventListener('mousedown', onDocumentMouseDown);
            document.addEventListener('touchstart', onDocumentMouseDown);

            raycaster = new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(0, - 1, 0), 0, 10);


            const texture = new THREE.TextureLoader().load('/ShowroomImages/floortile.jpg');

            // floor
            //StartGolv
            var geometry = new THREE.BoxGeometry(50, 1, 200);
            var material = new THREE.MeshLambertMaterial({ map: texture });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "floor";

            scene.add(mesh);
            mesh.position.set(0, 0, -90);


            //HögerGolv
            var geometry = new THREE.BoxGeometry(50, 1, 50);
            var material = new THREE.MeshLambertMaterial({ map: texture });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "floor";
            scene.add(mesh);
            mesh.position.set(50, 0, -15);


            //HögerLångGolv
            var geometry = new THREE.BoxGeometry(50, 1, 200);
            var material = new THREE.MeshLambertMaterial({ map: texture });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "floor";
            scene.add(mesh);
            mesh.position.set(100, 0, -90);


            //UppeGolv
            var geometry = new THREE.BoxGeometry(50, 1, 50);
            var material = new THREE.MeshLambertMaterial({ map: texture });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "floor";
            scene.add(mesh);
            mesh.position.set(50, 0, -165);




            // objects
            //Ytterväggar
            //vägg vänsterYtter
            var geometry = new THREE.BoxGeometry(1, 35, 205);
            var material = new THREE.MeshLambertMaterial({ color: 0xE1E1E1 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(-27, 17.5, -90);

            //Vägg bakomYtter
            var geometry = new THREE.BoxGeometry(155, 35, 1);
            var material = new THREE.MeshLambertMaterial({ color: 0xE1E1E1 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(50, 17.5, 12);

            //Vägg HögerYtter
            var geometry = new THREE.BoxGeometry(1, 35, 205);
            var material = new THREE.MeshLambertMaterial({ color: 0xE1E1E1 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(127, 17.5, -90);

            //väggFramYtter
            var geometry = new THREE.BoxGeometry(155, 35, 1);
            var material = new THREE.MeshLambertMaterial({ color: 0xE1E1E1 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(50, 17.5, -192);

            //Innerväggar


            //VäggVänsterInner
            var geometry = new THREE.BoxGeometry(1, 35, 97);
            var material = new THREE.MeshLambertMaterial({ color: 0xE1E1E1 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(27, 17.5, -90);

            //VäggBakInner
            var geometry = new THREE.BoxGeometry(45, 35, 1);
            var material = new THREE.MeshLambertMaterial({ color: 0xE1E1E1 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(50, 17.5, -42);

            //VäggHögerInner
            var geometry = new THREE.BoxGeometry(1, 35, 97);
            var material = new THREE.MeshLambertMaterial({ color: 0xE1E1E1 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(73, 17.5, -90);


            //väggFramInner
            var art = new THREE.TextureLoader().load('/ShowroomImages/global-art-tack.jpg');
            var geometry = new THREE.BoxGeometry(45, 35, 1);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall"
            scene.add(mesh);
            mesh.position.set(50, 17.5, -138);


            //Tak
            //StartTak
            var geometry = new THREE.BoxGeometry(50, 1, 200);
            var material = new THREE.MeshLambertMaterial({ color: 0xC5C5C2 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(0, 35, -90);


            //HögerTak
            var geometry = new THREE.BoxGeometry(50, 1, 50);
            var material = new THREE.MeshLambertMaterial({ color: 0xC5C5C2 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(50, 35, -15);


            //HögerLångTak
            var geometry = new THREE.BoxGeometry(50, 1, 200);
            var material = new THREE.MeshLambertMaterial({ color: 0xC5C5C2 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(100, 35, -90);


            //UppeTak
            var geometry = new THREE.BoxGeometry(50, 1, 50);
            var material = new THREE.MeshLambertMaterial({ color: 0xC5C5C2 });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "wall";
            scene.add(mesh);
            mesh.position.set(50, 35, -165);

            //PelareVänsterFram
            var geometry = new THREE.BoxGeometry(0.5, 35, 0.5);
            var material = new THREE.MeshLambertMaterial({ color: 0x000000 });
            var mesh = new THREE.Mesh(geometry, material);

            scene.add(mesh);
            mesh.position.set(-26, 17.5, -191);

            //PelareHögerFram
            var geometry = new THREE.BoxGeometry(0.5, 35, 0.5);
            var material = new THREE.MeshLambertMaterial({ color: 0x000000 });
            var mesh = new THREE.Mesh(geometry, material);

            scene.add(mesh);
            mesh.position.set(126, 17.5, -191);

            //PelareVänsterBak
            var geometry = new THREE.BoxGeometry(0.5, 35, 0.5);
            var material = new THREE.MeshLambertMaterial({ color: 0x000000 });
            var mesh = new THREE.Mesh(geometry, material);

            scene.add(mesh);
            mesh.position.set(-26, 17.5, 11);

            //PelareHögerBak
            var geometry = new THREE.BoxGeometry(0.5, 35, 0.5);
            var material = new THREE.MeshLambertMaterial({ color: 0x000000 });
            var mesh = new THREE.Mesh(geometry, material);

            scene.add(mesh);
            mesh.position.set(126, 17.5, 11);

            //Tavlor Vänsteryttervägg
            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(0).ImageName');

            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 1;
            //mesh.background = 0xFFFFFF;

            scene.add(mesh);
            mesh.position.set(-26.5, 12, -27);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(1).ImageName');
            console.log(art);
            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 2;
            //mesh.background = 0xFFFFFF;

            scene.add(mesh);
            mesh.position.set(-26.5, 12, -70);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(2).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 3;

            scene.add(mesh);
            mesh.position.set(-26.5, 12, -113);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(3).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 4;

            mesh.position.set(-26.5, 12, -156);
            scene.add(mesh);

            //Tavlor YtterFramVägg

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(4).ImageName');
            var geometry = new THREE.BoxGeometry(8, 10, 0.1);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 5;


            mesh.position.set(7, 12, -191.5);
            scene.add(mesh);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(5).ImageName');
            var geometry = new THREE.BoxGeometry(8, 10, 0.1);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 6;

            mesh.position.set(50, 12, -191.5);
            scene.add(mesh);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(6).ImageName');
            var geometry = new THREE.BoxGeometry(8, 10, 0.1);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 7;

            mesh.position.set(93, 12, -191.5);
            scene.add(mesh);

            //Tavlor YtterHögerVägg

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(7).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 8;

            mesh.position.set(126.5, 12, -27);
            scene.add(mesh);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(8).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 9;

            scene.add(mesh);
            mesh.position.set(126.5, 12, -70);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(9).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 10;

            scene.add(mesh);
            mesh.position.set(126.5, 12, -113);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(10).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 11;

            mesh.position.set(126.5, 12, -156);
            scene.add(mesh);

            //Tavla YtterväggBak


            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(11).ImageName');
            var geometry = new THREE.BoxGeometry(8, 10, 0.1);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 12;

            mesh.position.set(50, 12, 11.5);
            scene.add(mesh);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(12).ImageName');
            var geometry = new THREE.BoxGeometry(8, 10, 0.1);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 13;

            mesh.position.set(93, 12, 11.5);
            scene.add(mesh);


            //Tavla InnerväggVänster
            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(13).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 8, 13);
            var material = new THREE.MeshLambertMaterial({map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 14;

            mesh.position.set(26.5, 12, -70);
            scene.add(mesh);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(14).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 8, 13);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 15;

            mesh.position.set(26.5, 12, -113);
            scene.add(mesh);

            //TavlorInnerväggHöger
            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(15).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            material.color = { r: 255, g: 255, b: 255 };
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 16;

            mesh.position.set(73.5, 12, -70);
            scene.add(mesh);

            var art = new THREE.TextureLoader().load('/imagesArt/@Model.Images.ElementAt(16).ImageName');
            var geometry = new THREE.BoxGeometry(0.1, 10, 8);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.Number = 17;

            mesh.position.set(73.5, 12, -113);
            scene.add(mesh);

            //DörrYtterväggBak
            var art = new THREE.TextureLoader().load('/ShowroomImages/door.jpg');
            var geometry = new THREE.BoxGeometry(16, 20, 0.1);
            var material = new THREE.MeshLambertMaterial({ map: art });
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = "exit";

            mesh.position.set(0, 10, 11.5);
            scene.add(mesh);


            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            //

            window.addEventListener('resize', onWindowResize, false);

        }

        function onWindowResize() {

            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();

            renderer.setSize(window.innerWidth, window.innerHeight);

            if (window.innerWidth < 1000) {
                onMobileDevice = true;
                console.log('mobileDeviceTrue');
            } else {
                onMobileDevice = false;
                console.log('mobileDeviceFalse');
            }

        }


        function onDocumentMouseDown(event) {

            if (onMobileDevice === true) {
                mouse.x = (event.clientX / renderer.domElement.width ) * 2 - 1;
                mouse.y = -(event.clientY / renderer.domElement.height ) * 2 + 1;
            }
            else {

                mouse.x = 0; /*( event.clientX / renderer.domElement.width ) * 2 - 1;*/
                mouse.y = 0;/*- ( event.clientY / renderer.domElement.height ) * 2 + 1;*/ //If you want the raycaster to look at the position of the mouse
            }

            raycaster.setFromCamera(mouse, camera);
            raycaster.far = 100;
            raycaster.near = 0;

            var intersects = raycaster.intersectObjects(scene.children);
            console.log(intersects[0].object)
            if (intersects.length > 0 && intersects[0].object.name === 'exit') {
                exitIsClicked = true;
                controls.lock();
                controls.unlock();
            } else if (intersects.length > 0 && intersects[0].object.name != 'floor' && intersects[0].object.name != 'wall' && intersects[0].object.material.map.image.outerHTML != '<img crossorigin="anonymous" src="/imagesArt/EmptySpaceInShowroom.jpg">') {

                let image = intersects[0].object;
                artIsClicked = true;
                controls.lock();
                controls.unlock();
                
                showArtInfo(image);



                controls.unlock();


            }
           
        }


        function animate() {


            requestAnimationFrame(animate);

            const time = performance.now();

            if (controls.isLocked === true || onMobileDevice === true) {



                const delta = (time - prevTime) / 1500;

                velocity.x -= velocity.x * 10.0 * delta;
                velocity.z -= velocity.z * 10.0 * delta;

                velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass

                direction.z = Number(moveForward) - Number(moveBackward);
                direction.x = Number(moveRight) - Number(moveLeft);
                direction.normalize(); // this ensures consistent movements in all directions


                if (moveForward || moveBackward) velocity.z -= direction.z * 400.0 * delta;
                if (moveLeft || moveRight) velocity.x -= direction.x * 400.0 * delta;

                if (controls.getObject().position.x > 122) {
                    controls.getObject().position.x = 122;
                }
                if (controls.getObject().position.z > 7) {
                    controls.getObject().position.z = 7;
                }
                if (controls.getObject().position.x < -23) {
                    controls.getObject().position.x = -23;
                }
                if (controls.getObject().position.z < -187) {
                    controls.getObject().position.z = -187;
                }

                //VäggVänsterInner
                if ((controls.getObject().position.x > 21 && controls.getObject().position.x < 73) &&
                    (controls.getObject().position.z < -42 && controls.getObject().position.z > -138)) {
                    controls.getObject().position.x = 21;
                }
                //VäggBakInner
                if ((controls.getObject().position.x > 27 && controls.getObject().position.x < 73) &&
                    (controls.getObject().position.z < -36 && controls.getObject().position.z > -42)) {
                    controls.getObject().position.z = -36;
                }//VäggHögerInner
                if ((controls.getObject().position.x > 73 && controls.getObject().position.x < 77) &&
                    (controls.getObject().position.z < -42 && controls.getObject().position.z > -138)) {
                    controls.getObject().position.x = 77;
                }
                //VäggFramInner
                if ((controls.getObject().position.x > 27 && controls.getObject().position.x < 73) &&
                    (controls.getObject().position.z > -142 && controls.getObject().position.z < -138)) {
                    controls.getObject().position.z = -142;
                }


                controls.moveRight(- velocity.x * delta);
                controls.moveForward(- velocity.z * delta);

                controls.getObject().position.y += (velocity.y * delta); // new behavior

                if (controls.getObject().position.y < 10) {

                    velocity.y = 0;
                    controls.getObject().position.y = 10;

                    canJump = true;

                }
                if (controls.getObject().position.x < 10) {

                    velocity.y = 0;
                    controls.getObject().position.y = 10;

                    canJump = true;

                }

            }

            prevTime = time;

            renderer.render(scene, camera);

        }

    </script>
</body>
</html>
